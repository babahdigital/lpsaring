# backend/.env.public.example
# Template PUBLIC (tanpa secret). Bisa dishare ke tim.
# Jangan commit backend/.env.public jika berisi secret.

# --- Public URLs / CORS ---
APP_PUBLIC_BASE_URL=https://example.com
FRONTEND_URL=https://example.com
CORS_ADDITIONAL_ORIGINS=["https://example.com"]
APP_LINK_USER=https://example.com/login
APP_LINK_ADMIN=https://example.com/admin
APP_LINK_ADMIN_CHANGE_PASSWORD=https://example.com/akun
APP_LINK_MIKROTIK=https://192.168.88.1

# --- App locale/presentation ---
APP_LOCALE=id_ID.UTF-8
APP_TIMEZONE=Asia/Makassar
CURRENCY_SYMBOL=Rp 
JINJA_DATETIME_FORMAT=%d/%m/%y %H:%M
JINJA_DATETIME_SHORT_FORMAT=%b %d, %Y

# --- Debug/ops knobs ---
SQLALCHEMY_ECHO=False
REDIS_CONNECT_TIMEOUT=5
REDIS_SOCKET_TIMEOUT=5
STATUS_PAGE_TOKEN_MAX_AGE_SECONDS=300
PUBLIC_DB_UPDATE_FORM_ENABLED=False

# --- Shareable public transaction status link (signed token `t`) ---
# TTL token untuk link shareable (default aplikasi 7 hari; clamp min 5 menit, max 30 hari)
TRANSACTION_STATUS_TOKEN_MAX_AGE_SECONDS=604800

# --- Optional access/device policy knobs (non-secret) ---
MIKROTIK_DHCP_STATIC_LEASE_ENABLED=False
DEVICE_AUTO_REPLACE_ENABLED=False
MIKROTIK_BLOCKED_PROFILE=profile-blokir
MIKROTIK_ADDRESS_LIST_BLOCKED=klient_blocked
IP_BINDING_TYPE_ALLOWED=regular
IP_BINDING_TYPE_BLOCKED=blocked

# Quota sync & debt policy (non-secret)
QUOTA_SYNC_INTERVAL_SECONDS=300
# Jika auto debt (used - purchased - auto_debt_offset) >= limit ini (MB):
# - app status blocked,
# - profile dipaksa ke MIKROTIK_BLOCKED_PROFILE,
# - address-list dipaksa ke MIKROTIK_ADDRESS_LIST_BLOCKED,
# - ip-binding tetap non-blocked (regular) untuk flow auto debt.
# Set 0 untuk mematikan fitur.
QUOTA_DEBT_LIMIT_MB=500
QUOTA_FUP_THRESHOLD_MB=3072

# --- Proxy trust / client IP policy ---
PROXYFIX_X_FOR=1
PROXYFIX_X_PROTO=1
PROXYFIX_X_HOST=0
PROXYFIX_X_PORT=0
PROXYFIX_X_PREFIX=0
TRUST_CF_CONNECTING_IP=True
TRUSTED_PROXY_CIDRS=['127.0.0.1/32','10.0.0.0/8','172.16.0.0/12','192.168.0.0/16']
HOTSPOT_CLIENT_IP_CIDRS=['10.0.0.0/8','172.16.0.0/12','192.168.0.0/16']

# Unauthorized host blocking (optional; used by `flask sync-unauthorized-hosts`)
MIKROTIK_UNAUTHORIZED_CIDRS=['172.16.2.0/23']

# Optional: limit managed static DHCP leases (lpsaring|static-dhcp) to these CIDRs.
# If not set/empty, the app falls back to MIKROTIK_UNAUTHORIZED_CIDRS.
# MIKROTIK_DHCP_STATIC_LEASE_CIDRS=['172.16.2.0/23']
MIKROTIK_UNAUTHORIZED_EXEMPT_IPS=['172.16.2.3-7']

# --- Rate limit API ---
API_RATE_LIMIT=100 per minute
RATELIMIT_STRATEGY=fixed-window
RATELIMIT_ENABLED=True
PING_RATE_LIMIT=10 per minute
INITIATE_TRANSACTION_RATE_LIMIT=10 per minute

# Rate limit endpoint public transaksi (pakai token `t`)
PUBLIC_TRANSACTION_STATUS_RATE_LIMIT=60 per minute
PUBLIC_TRANSACTION_QR_RATE_LIMIT=30 per minute
PUBLIC_TRANSACTION_CANCEL_RATE_LIMIT=20 per minute
OTP_REQUEST_RATE_LIMIT=5 per minute;20 per hour
OTP_VERIFY_RATE_LIMIT=10 per minute;60 per hour
ADMIN_LOGIN_RATE_LIMIT=10 per minute;60 per hour
REGISTER_RATE_LIMIT=5 per minute;20 per hour
SESSION_CONSUME_RATE_LIMIT=30 per minute
AUTO_LOGIN_RATE_LIMIT=60 per minute

# --- Midtrans knobs (non-secret) ---
MIDTRANS_DEFAULT_EXPIRY_MINUTES=15

# --- WhatsApp (non-secret knobs only) ---
ENABLE_WHATSAPP_NOTIFICATIONS=True
WHATSAPP_HTTP_TIMEOUT_SECONDS=15
WHATSAPP_PDF_DOWNLOAD_TIMEOUT_SECONDS=20
WHATSAPP_SEND_DELAY_MIN_MS=400
WHATSAPP_SEND_DELAY_MAX_MS=1200
WHATSAPP_RATE_LIMIT_ENABLED=True
WHATSAPP_RATE_LIMIT_WINDOW_SECONDS=60
WHATSAPP_RATE_LIMIT_PER_TARGET=3
WHATSAPP_RATE_LIMIT_GLOBAL=120
