# backend/.env.local
# Gunakan untuk akses lokal (lpsaring.local)

FLASK_APP=run.py
FLASK_ENV=development
SECRET_KEY=584417b029085ae2ae252adea8bc91d24e3e2a6882467eaa3965c304484c39c7
JWT_SECRET_KEY=1d2a9ce48e0c2a9c2fdd0ef2170a27f862b9c7a6d58ffeb6dd3b3d2b6d6f7a4f
JWT_ACCESS_TOKEN_EXPIRES_MINUTES=30
FLASK_DEBUG=True
ENABLE_ADMIN_ROUTES=True

DB_ENGINE=postgresql
DB_DRIVER=psycopg2
DB_USER=hotspot_user
DB_PASSWORD=alhabsyi
DB_HOST=db
DB_PORT=5432
DB_NAME=hotspot_db
DATABASE_URL=postgresql+psycopg2://hotspot_user:alhabsyi@db:5432/hotspot_db

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_HOST_OTP=redis
REDIS_PORT_OTP=6379
REDIS_DB_OTP=0
REDIS_PASSWORD_OTP=
REDIS_HOST_CELERY_BROKER=redis
REDIS_PORT_CELERY_BROKER=6379
REDIS_DB_CELERY_BROKER=1
REDIS_PASSWORD_CELERY_BROKER=
REDIS_HOST_CELERY_BACKEND=redis
REDIS_PORT_CELERY_BACKEND=6379
REDIS_DB_CELERY_BACKEND=2
REDIS_PASSWORD_CELERY_BACKEND=
REDIS_HOST_RATELIMIT=redis
REDIS_PORT_RATELIMIT=6379
REDIS_DB_RATELIMIT=0
REDIS_PASSWORD_RATELIMIT=
RATELIMIT_STORAGE_URI=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/1

MIDTRANS_SERVER_KEY=SB-Mid-server-IjnL8HGa6FfK1cbNLdrD5jtq
MIDTRANS_CLIENT_KEY=SB-Mid-client-ZRQkWJJFVv-8oZ40
MIDTRANS_IS_PRODUCTION=False
MIDTRANS_HTTP_TIMEOUT_SECONDS=15
MIDTRANS_WEBHOOK_IDEMPOTENCY_TTL_SECONDS=86400

WHATSAPP_API_URL=https://api.fonnte.com/send
WHATSAPP_VALIDATE_URL=https://api.fonnte.com/validate
WHATSAPP_API_KEY=g7A8dpDfJrnR5SBGXunU
ENABLE_WHATSAPP_NOTIFICATIONS=True
WHATSAPP_HTTP_TIMEOUT_SECONDS=15
WHATSAPP_PDF_DOWNLOAD_TIMEOUT_SECONDS=20

MIKROTIK_HOST=10.10.83.1
MIKROTIK_USER=abdullah
MIKROTIK_PASSWORD=alhabsyi
MIKROTIK_PORT=8728
MIKROTIK_USE_SSL=False
MIKROTIK_SSL_VERIFY=False
MIKROTIK_PLAIN_TEXT_LOGIN=True
MIKROTIK_DEFAULT_PROFILE=default
MIKROTIK_INACTIVE_PROFILE=inactive
MIKROTIK_ACTIVE_PROFILE=profile-aktif
MIKROTIK_FUP_PROFILE=profile-fup
MIKROTIK_HABIS_PROFILE=profile-habis
MIKROTIK_UNLIMITED_PROFILE=profile-unlimited
MIKROTIK_EXPIRED_PROFILE=profile-expired
MIKROTIK_DEFAULT_SERVER=testing
MIKROTIK_DEFAULT_SERVER_USER=testing
MIKROTIK_DEFAULT_SERVER_KOMANDAN=testing
MIKROTIK_KOMANDAN_PROFILE=profile-aktif
MIKROTIK_SEND_LIMIT_BYTES_TOTAL=False
MIKROTIK_SEND_SESSION_TIMEOUT=False
MIKROTIK_ADDRESS_LIST_ACTIVE=klient_aktif
MIKROTIK_ADDRESS_LIST_FUP=klient_fup
MIKROTIK_ADDRESS_LIST_INACTIVE=klient_inactive
MIKROTIK_ADDRESS_LIST_EXPIRED=klient_expired
MIKROTIK_ADDRESS_LIST_HABIS=klient_habis
MIKROTIK_ADDRESS_LIST_BLOCKED=klient_blocked
IP_BINDING_ENABLED=True
IP_BINDING_TYPE_ALLOWED=regular
IP_BINDING_TYPE_BLOCKED=blocked
HOTSPOT_BYPASS_STATUSES=['active','fup','unlimited']
IP_BINDING_FAIL_OPEN=False
MAX_DEVICES_PER_USER=3
REQUIRE_EXPLICIT_DEVICE_AUTH=True
DEVICE_STALE_DAYS=30
WALLED_GARDEN_ENABLED=True
WALLED_GARDEN_ALLOWED_HOSTS=["lpsaring.local","localhost"]
WALLED_GARDEN_ALLOWED_IPS=["10.0.0.6-10.0.0.6"]
WALLED_GARDEN_MANAGED_COMMENT_PREFIX=lpsaring
WALLED_GARDEN_SYNC_INTERVAL_MINUTES=30
SYNC_ADDRESS_LIST_ON_LOGIN=True
SESSION_TOKEN_EXPIRE_SECONDS=120
OTP_ALLOW_BYPASS=True
OTP_BYPASS_CODE=000000
OTP_EXPIRE_SECONDS=300
OTP_REQUEST_COOLDOWN_SECONDS=60
OTP_VERIFY_MAX_ATTEMPTS=5
OTP_VERIFY_WINDOW_SECONDS=300
OTP_FINGERPRINT_ENABLED=True

# Dev bypass untuk endpoint /api/users/me/* (development only)
DEV_BYPASS_USER_ENDPOINTS=False
DEV_BYPASS_USER_PHONE=
DEV_BYPASS_USER_ID=
DEV_BYPASS_TOKEN=

# Auth cookie (HttpOnly)
AUTH_COOKIE_NAME=auth_token
AUTH_COOKIE_HTTPONLY=True
AUTH_COOKIE_SECURE=False
AUTH_COOKIE_SAMESITE=Lax
AUTH_COOKIE_PATH=/
AUTH_COOKIE_DOMAIN=
AUTH_COOKIE_MAX_AGE_SECONDS=1800
CSRF_PROTECT_ENABLED=True
CSRF_TRUSTED_ORIGINS=["http://lpsaring.local"]
CSRF_STRICT_NO_ORIGIN=True
CSRF_NO_ORIGIN_ALLOWED_IPS=["10.10.83.1","10.10.83.2","10.0.0.6","172.16.0.0/12"]

# Sinkronisasi Kuota & Notifikasi
QUOTA_SYNC_INTERVAL_SECONDS=60
QUOTA_FUP_PERCENT=20
QUOTA_NOTIFY_PERCENTAGES=[20,10,5]
QUOTA_EXPIRY_NOTIFY_DAYS=[7,3,1]
INACTIVE_DEACTIVATE_DAYS=45
INACTIVE_DELETE_DAYS=90
AUTO_ENROLL_DEVICES_FROM_IP_BINDING=True
AUTO_ENROLL_DEBUG_LOG=False

# Kebijakan Permintaan Komandan
KOMANDAN_REQUEST_WINDOW_HOURS=24
KOMANDAN_REQUEST_MAX_PER_WINDOW=1
KOMANDAN_REQUEST_COOLDOWN_HOURS=6
KOMANDAN_ALLOW_UNLIMITED_REQUEST=True
KOMANDAN_MAX_QUOTA_MB=51200
KOMANDAN_MAX_QUOTA_DAYS=30
KOMANDAN_MAX_UNLIMITED_DAYS=30

# Konfigurasi ProxyFix
PROXYFIX_X_FOR=1
PROXYFIX_X_PROTO=1
PROXYFIX_X_HOST=0
PROXYFIX_X_PORT=0
PROXYFIX_X_PREFIX=0
TRUST_CF_CONNECTING_IP=False
TRUSTED_PROXY_CIDRS=['127.0.0.1/32','10.0.0.0/8','172.16.0.0/12','192.168.0.0/16']

APP_TIMEZONE=Asia/Makassar
LOG_TO_FILE=False
LOG_LEVEL=DEBUG
LOG_DIR=logs
LOG_FILENAME=hotspot_portal.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5
LOG_FILE_LEVEL=INFO
LOG_FORMAT_JSON=True
LOG_IP_HEADER_DEBUG=False
LOG_BINDING_DEBUG=True
HOTSPOT_CLIENT_IP_CIDRS=['10.0.0.0/8','172.16.0.0/12','192.168.0.0/16']
FRONTEND_URL=http://lpsaring.local
APP_PUBLIC_BASE_URL=http://lpsaring.local
CORS_ADDITIONAL_ORIGINS=["http://lpsaring.local"]
APP_LINK_USER=http://lpsaring.local/login
APP_LINK_ADMIN=http://lpsaring.local/admin
APP_LINK_ADMIN_CHANGE_PASSWORD=http://lpsaring.local/akun
API_RATE_LIMIT=100 per minute
RATELIMIT_STRATEGY=fixed-window
RATELIMIT_ENABLED=True
PING_RATE_LIMIT=10 per minute
OTP_REQUEST_RATE_LIMIT=5 per minute;20 per hour
OTP_VERIFY_RATE_LIMIT=10 per minute;60 per hour
ADMIN_LOGIN_RATE_LIMIT=10 per minute;60 per hour
REGISTER_RATE_LIMIT=5 per minute;20 per hour
SESSION_CONSUME_RATE_LIMIT=30 per minute
AUTO_LOGIN_RATE_LIMIT=60 per minute
PUBLIC_SETTINGS_CACHE_TTL_SECONDS=300
METRICS_TTL_SECONDS=86400
TASK_DLQ_REDIS_KEY=celery:dlq
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RESET_SECONDS=60
CIRCUIT_BREAKER_HALF_OPEN_SUCCESS=2

# Super Admin init (opsional)
SUPERADMIN_PHONE=0811xxxxxxx
SUPERADMIN_NAME=Super Admin
SUPERADMIN_PASSWORD=changeme123
