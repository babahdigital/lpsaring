# Worklog 2026-02-25

Ringkasan perubahan fokus stabilisasi produksi + iterasi UI admin berdasarkan feedback.

## Perubahan Utama

- Stabilisasi produksi pasca rilis debt + Komandan:
  - Perbaikan UX `Unlimited Time` di Admin Edit User.
  - Komandan dashboard chart tidak lagi stuck loading.
  - Endpoint bind device ditambah mode `best_effort` untuk mengurangi 403 noise.
  - Nginx hide CSP upstream untuk mengurangi spam report-only.

- UX dialog fullscreen + responsif:
  - Dialog admin edit/detail user lebih nyaman di mobile.
  - Dialog komandan request header pakai toolbar (X selalu di kanan atas).

- Admin Users (iteratif):
  - Default `Tanggal Tunggakan` otomatis hari ini saat toggle tunggakan diaktifkan.
  - Tambah kolom `PROFILE` (Aktif/Blocked/FUP/Habis/Expired/Unlimited) + badge Debt.
  - Perapihan layout mobile: toolbar, search + tombol tambah, nama panjang vs badge, preview cleanup.

- Fix pagination server-side:
  - Klik nomor halaman tidak lagi balik ke page 1 karena watcher.
  - Pola fetch/pagination diselaraskan lintas halaman admin.

- UI polish:
  - Datepicker (Flatpickr) lebih stabil di dialog (posisi popup + konsistensi ukuran).
  - Hint switch dipendekkan.
  - Spacing tabel “Riwayat Tunggakan Manual” diperbaiki.

- Ops:
  - Deploy ke Raspberry Pi pakai `--prune` + verifikasi migrate exit code.
  - Cleanup GitHub Actions caches dan hapus workflow runs lama (sisakan 2 terbaru).

## Commit terkait (ringkas)

- `2298dfe3`, `c13dd4ff`, `bb796bd1`
- `d508191a`, `fc633cbd`, `bebf9e55`, `d76146d4`, `2e09754f`

## Update Sesi Lanjutan (Merchant/Legal + Demo + Deploy)

- Tambah halaman public merchant center:
  - `/merchant-center`
  - `/merchant-center/privacy`
  - `/merchant-center/terms`
- Konten legal diselaraskan dengan flow pembayaran aktual dan kanal bantuan merchant.
- Centralized merchant profile via env public + runtime config + composable agar konsisten di semua halaman.
- Penyesuaian tampilan legal page agar mendekati referensi `dev/privacy/index-1.html`.
- Implementasi demo mode berbasis env (OTP bypass terkontrol + paket testing terkontrol untuk demo user).
- Deploy ulang produksi dengan `--prune` berhasil dan health check backend OK.

### Kendala yang Tercatat

- Cloudflare 1010 saat pengujian dari sisi lokal (diatasi dengan simulasi internal server).
- Kalibrasi style legal page perlu iterasi kedua karena visual awal terlalu keras.
- Masalah kalender/datepicker masih dilaporkan ada pada skenario tertentu (**belum final**).

## Update Tambahan (Demo Package Finalization)

- Koreksi backend eksposur paket publik:
  - Paket testing nonaktif kini hanya terlihat untuk requester yang terverifikasi sebagai demo user.
  - User reguler kembali hanya melihat paket aktif normal.
- Sinkronisasi frontend `/beli` dan `/captive/beli`:
  - Info mode demo dibuat lebih ringkas menjadi badge `Demo` berwarna.
  - Label tombol paket terblokir di mode demo diubah menjadi `Disable`.
- Delivery:
  - Commit `8ead0f91` (fix visibilitas paket demo nonaktif + perbaikan label).
  - Commit `ebd3f314` (UI simplification badge demo + label disable).
  - Deploy ulang production (`deploy_pi.sh --prune`) berhasil, health check `/api/ping` OK.

## Lanjutan 2026-02-26

Dokumentasi detail lanjutan (refinement UI halaman beli, perbaikan mobile card width + lock horizontal scroll, commit/push final, deploy `--prune` berulang, dan klarifikasi operasional demo user) tersedia di:

- `docs/DEVLOG_2026-02-26.md`
